---
const { selectedItem } = Astro.props;

const links = [
  { href: "/", name: "Home", icon: "home.svg", key: "home" },
  {
    href: "/software-development",
    name: "Software Development",
    icon: "code.svg",
    key: "software-development",
  },
  { href: "/devops", name: "DevOps", icon: "dns.svg", key: "devops" },
  {
    href: "/personal-projects",
    name: "Personal Projects",
    icon: "favorite.svg",
    key: "personal-projects",
  },
  {
    href: "/experience",
    name: "Experience",
    icon: "history.svg",
    key: "experience",
  },
  { href: "/about", name: "About Me", icon: "about.svg", key: "about" },
  { href: "/resume", name: "Resume", icon: "resume.svg", key: "resume" },
  {
    href: "https://bisw4sh.github.io/hugo-blogs",
    name: "Blogs",
    icon: "rss.svg",
    external: true,
  },
];
---

<aside
  class="sidebar w-nav"
  data-animation="default"
  data-collapse="medium"
  data-duration="400"
  data-easing="ease"
  data-easing2="ease"
>
  <div class="nav-content">
    <a href="/" class="w-nav-brand" aria-label="home">
      <div class="niv-data">
        <img
          src="/assets/images/main.webp"
          loading="eager"
          alt="Profile picture"
          class="niv-image"
        />
        <div>
          <div class="label-white">Biswash Dhungana</div>
          <div class="label-gray">Software Engineer</div>
        </div>
      </div>
    </a>

    <nav role="navigation" class="w-nav-menu">
      {
        links.map((link) => (
          <a
            href={link.href}
            class={`nav-link-container w-inline-block ${
              selectedItem === link.key ? "w--current" : ""
            }`}
            aria-current={selectedItem === link.key ? "page" : undefined}
            target={link.external ? "_blank" : undefined}
          >
            <img
              src={`/assets/svgs/${link.icon}`}
              alt={link.name}
              loading="eager"
              class="nav-link-image"
            />
            <div>{link.name}</div>
          </a>
        ))
      }
    </nav>

    <button
      class="navbar-icon-button w-nav-button"
      aria-label="Toggle menu"
      aria-expanded="false"
      type="button"
    >
      <img src="/assets/svgs/menu.svg" alt="menu" class="navbar-icon" />
    </button>
  </div>
</aside>

<script>
  import { setupNav } from "../scripts/nav.js";

  let cleanup;

  const initNav = () => {
    if (cleanup) cleanup();
    cleanup = setupNav();
  };

  document.addEventListener("astro:page-load", initNav);
  document.addEventListener("astro:after-swap", initNav);
  document.addEventListener("astro:before-swap", () => cleanup?.());

  initNav();
</script>
